language: node_js
dist: trusty
node_js:
- 8.9.4
jobs:
  include:
  - stage: Test
    script: npm test
  - stage: Deploy Staging
    if: type IN (push)
    script: skip
    before_deploy:
      - echo Deploy Staging before_deploy
    deploy:
    - provider: script
      skip_cleanup: true
      script:
      - echo travis_branch:$TRAVIS_BRANCH
      on:
        tags: false
  - stage: Deploy Tag
    if: type IN (push)
    script: skip
    before_deploy:
      - echo Deploy Tag before_deploy
    deploy:
    - provider: script
      skip_cleanup: true
      script:
      - echo travis_tag:$TRAVIS_TAG
      - cd $TRAVIS_BUILD_DIR
      - tar -zcf /tmp/nn-$TRAVIS_TAG.tar.gz *
      - du -hs /tmp/nn-$TRAVIS_TAG.tar.gz
      on:
        tags: true
